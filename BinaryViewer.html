<!DOCTYPE html>
<html lang="fr">
	<head>

		<!-- Encodage et compatibilité -->
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Informations -->
		<title>Binary Viewer (Offset + Hex + ASCII)</title>
		<meta name="description" content="Small hexadecimal and ASCII viewer to explore the binary contents of files.">
		<meta name="author" content="VincentD">
		<meta name="keywords" content="hex viewer, ascii, binary, file, binaire, fichier, dump">

		<link rel="stylesheet" href="css/styles.css">

		<!-- Favicon -->
		<link rel="icon" href="Logos/RPUFOS_Logo.ico" type="image/x-icon">
		<link rel="apple-touch-icon" href="Logos/apple-touch-icon.png">

		<!-- Scripts éventuels -->
		<!-- <script src="script.js" defer></script> -->
	</head>
	<!--  -->
	<body>
		<!-- Header -->
		<header>
			<div class="header-container">
				<a href="index.html">
					<img src="Logos/RPUFOS_Logo-512.png" alt="Logo" class="logo" />
				</a>
				<h1>Binary Viewer (Offset + Hex + ASCII)</h1>
			</div>
		</header>

		<hr />
		<!-- MAIN -->
		<main>
			<section class="controls">
				<div class="buttons">
					<input id="file" type="file" style="display:none">
					<button onclick="document.getElementById('file').click()">Charger un fichier</button>
					<br /><hr />
					<label><input type="checkbox" id="showOffset" checked> Show offset</label>
					<label><input type="checkbox" id="showAscii" checked> Show ASCII</label>
					<!-- Offset input -->
					<div class="options-extra">
						Offset (hex) : <input type="text" id="startOffset" value="0000">
					</div>
				</div>
				<!-- Show filename -->
				<hr />
				<div id="filename">Aucun fichier chargé</div>
			</section>
			<!-- Testarea output -->
			<hr />
			<section class="viewer">
				<div class="text-size-controls">
					<button onclick="changeTextSize(-1)">A-</button>
					<button onclick="changeTextSize(1)">A+</button>
				</div>
			<textarea id="output" readonly></textarea>
			</section>
			<hr />
			<p>Reload or F5 or CTRL+F5 to reset.
		</main>
		<!--  -->
		<hr />
		<footer>

			<img src="Logos/CC-BY-NC-ND-EU.png" alt="CC by NC ND EU" />
			<p>&copy; 2025 Hex Viewer – VincentD</p>
			<br />
		</footer>
<!-- ========== -->
<!-- JavaScript -->
<!-- ========== -->
<script>

// --------
// Listener
// --------
document.getElementById('file').addEventListener('change', e=>{
  const f = e.target.files[0];
  if (!f) return;
  document.getElementById('filename').textContent = "Fichier : " + f.name;
  const reader = new FileReader();
  reader.onload = ()=>{
    const bytes = new Uint8Array(reader.result);
    document.getElementById('output').value = makeHexAsciiDump(bytes);
  };
  reader.readAsArrayBuffer(f);
});

// -----------------------------
// Change textarea font size
// -----------------------------
function changeTextSize(delta){
  const output = document.getElementById('output');
  const style = window.getComputedStyle(output);
  const currentSize = parseFloat(style.fontSize);
  let newSize = currentSize + delta;
  if(newSize < 8) newSize = 8;      // minimum size
  if(newSize > 32) newSize = 32;    // maximum size
  output.style.fontSize = newSize + "px";
}


// -----------------------------
// Build Hex/ASCII Viewer Output
// -----------------------------
function makeHexAsciiDump(bytes){
  const showOffset = document.getElementById('showOffset').checked;
  const showAscii  = document.getElementById('showAscii').checked;

  // Reading the offset in hex (e.g., ‘0C000’)
  let startOffsetStr = document.getElementById('startOffset').value.trim();
  if (startOffsetStr.startsWith("0x")) {
    startOffsetStr = startOffsetStr.slice(2); // avoid "0x" if présent
  }
  const startOffset = parseInt(startOffsetStr, 16) || 0;

  let out = "";
  for (let i=0; i<bytes.length; i+=16){
    let hexPart = "";
    let asciiPart = "";
    for (let j=0; j<16; j++){
      if (i+j < bytes.length){
        const b = bytes[i+j];
        hexPart += b.toString(16).toUpperCase().padStart(2,"0")+" ";
        asciiPart += (b>=32 && b<=126) ? String.fromCharCode(b) : ".";
      } else {
        hexPart += "   ";
        asciiPart += " ";
      }
      if (j===7) hexPart += " ";
    }
    let line = "";
    if (showOffset){
      const offset = (startOffset + i).toString(16).toUpperCase().padStart(8,"0");
      line += offset + "  ";
    }
    line += hexPart;
    if (showAscii){
      line += " " + asciiPart;
    }
    out += line + "\n";
  }
  return out.trim();
}

// --------------------------------------------
// Recalculate the dump when the options change
// --------------------------------------------
["showOffset","showAscii","startOffset"].forEach(id=>{
  document.getElementById(id).addEventListener('change', ()=>{
    const fileInput = document.getElementById('file');
    if (fileInput.files[0]) {
      const reader = new FileReader();
      reader.onload = ()=>{
        const bytes = new Uint8Array(reader.result);
        document.getElementById('output').value = makeHexAsciiDump(bytes);
      };
      reader.readAsArrayBuffer(fileInput.files[0]);
    }
  });
});

</script>
<!-- ============= -->
<!-- End of script -->
<!-- ============= -->
	</body>
	
</html>
